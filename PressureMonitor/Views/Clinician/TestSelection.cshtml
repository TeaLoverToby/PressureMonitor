@{
    ViewData["Title"] = "Test Selection";
    var patients = ViewBag.Patients as List<PressureMonitor.Models.Patient>;
}
<div class="container mt-4">
    <h1>Test Dashboard - View Patient Pressure Data</h1>
    <p>Temporary test page for demonstrating clinician viewing patient data.</p>
    @if (patients == null || !patients.Any())
    {
        <div class="alert alert-warning">No patients found.</div>
    }
    else
    {
        <div class="list-group">
        @foreach (var patient in patients)
        {
            <div class="list-group-item">
                <h5 class="mb-1">@patient.User.Username (ID: @patient.Id)</h5>
                @if (patient.PressureMaps.Any())
                {
                    <div class="d-flex flex-wrap gap-2 mt-2">
                        @foreach (var map in patient.PressureMaps.OrderByDescending(pm => pm.Day).DistinctBy(pm => pm.Day))
                        {
                            <a asp-action="ViewPatientPressureMap" asp-route-patientId="@patient.Id" asp-route-day="@map.Day.ToString("yyyy-MM-dd")"
                                class="btn btn-outline-primary btn-sm">
                                View @map.Day.ToString("MM/dd/yyyy")
                            </a>
                        }
                    </div>
                }
                else
                {
                    <p class="text-muted mb-0">No pressure maps available.</p>
                }
            </div>
        }
        </div>
    }
</div>
